if(!0!==window.contentScriptInjected){window.contentScriptInjected=!0;const e=document.getElementsByClassName("thumbnail-image"),n=document.getElementsByClassName("page-title")[0],t=n?.innerHTML,l=[];for(const n of e){const e=n.style.backgroundImage.match(/^.*(https.*album_thumbnail\/(media_albums\/.*\.jpg)).*$/),t=e[1],i=t.replace("album_thumbnail","album_large"),o=`${window.origin}/system/files/${e[2]}`;l.push({thumbnail:t,large:i,full:o})}const i=document.createElement("button");i.innerHTML=`Download ${l.length} Photos`,i.type="button",i.className="link-btn",i.style="height: 30px",i.onclick=function(){console.log(`Zipping ${l.length} images to '${t}.zip' ...`),s.style.display="block",a.style.display="block";const e=new JSZip;var n=0;l.forEach((function(t,i){const o=`${i}.jpg`;e.file(o,new Promise((function(e,i){JSZipUtils.getBinaryContent(t.full,(function(t,o){if(t)i(t);else{e(o),n+=1;const t=parseInt(100*n/l.length);s.value=t,a.innerHTML=t+"%"}}))})),{binary:!0})})),e.generateAsync({type:"blob"},(function(e){n===l.length&&(a.innerHTML=`Zipping... ${parseInt(e.percent)}%`)})).then((function(e){s.style.display="none",s.value=0,a.innerHTML="0%",a.style.display="none",console.log(`Downloading '${t}.zip' ...`),saveAs(e,`${t}.zip`)}))};const o=document.createElement("div");o.style="padding-top: 12px;";const a=document.createElement("p");a.id="percentage",a.innerHTML="0%",a.style="display: none;";const s=document.createElement("progress");s.id="download-progress",s.max=100,s.value=0,s.style="display: none; margin-top: 10px; width: 240px;",o.appendChild(i),o.appendChild(s),o.appendChild(a),n.parentNode.insertBefore(o,n.nextSibling)}